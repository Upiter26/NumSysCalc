<!DOCTYPE html>
<html>
<head>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root { --bg: #9bc9ff; --text: #1a6dad; }
    .dark-theme { --bg: #192841; --text: #e0e0e0; }
    body {
      background-color: var(--bg);
      color: var(--text);
      font-family: Arial, sans-serif;
      height: 100%;
      position: relative;
      transition: background 0.3s;
    }
    .header {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px 20px;
      height: 100%;
    }
    .theme-btn {
      position: absolute;
      top: 15px;
      right: 20px;
      background: #4a90e2; /* светлая тема */
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    .dark-theme .theme-btn {
      background: #1a6dad; /* тёмная тема */
    }
  </style>
</head>
<body>
  <button class="theme-btn" onclick="toggleTheme()">🌓</button>
  <div class="header">
    <img id="theme-icon" src="icon-light.png" alt="Калькулятор" width="80" height="80">
    <span style="font-size:28px;font-weight:bold;">Калькулятор систем счисления</span>
  </div>

  <script>
    function updateIcon(isDark) {
      const icon = document.getElementById('theme-icon');
      if (icon) {
        icon.src = isDark ? 'icon-dark.png' : 'icon-light.png';
      }
    }

    function toggleTheme() {
      const isDark = !document.body.classList.contains('dark-theme');
      document.body.classList.toggle('dark-theme', isDark);
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      updateIcon(isDark);
      
      // Перезагрузка фреймов
      try {
        parent.frames['Блок 2'].location.reload();
        parent.frames['Блок 3'].location.reload();
      } catch (e) {
        const f2 = parent.document.querySelector('frame[name="Блок 2"]');
        const f3 = parent.document.querySelector('frame[name="Блок 3"]');
        if (f2) f2.src = f2.src;
        if (f3) f3.src = f3.src;
      }
    }

    // ✅ ГЛАВНОЕ: применяем тему ПРИ ЗАГРУЗКЕ
    const savedTheme = localStorage.getItem('theme');
    const isDark = (savedTheme === 'dark');
    
    if (isDark) {
      document.body.classList.add('dark-theme');
    }
    
    updateIcon(isDark);
  </script>
</body>
</html>